<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>IPsec on Keep calm and Write something</title><link>https://cychong47.github.io/tags/ipsec/</link><description>Recent content in IPsec on Keep calm and Write something</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Sun, 01 Apr 2018 02:38:40 +0000</lastBuildDate><atom:link href="https://cychong47.github.io/tags/ipsec/index.xml" rel="self" type="application/rss+xml"/><item><title>how to build IPsec packet with scapy</title><link>https://cychong47.github.io/post/2016/how-to-use-snapy-for-ipsec/</link><pubDate>Sun, 14 Feb 2016 14:59:42 +0900</pubDate><guid>https://cychong47.github.io/post/2016/how-to-use-snapy-for-ipsec/</guid><description>&lt;h2 id="import-modules"&gt;import modules&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$ python
&amp;gt;&amp;gt;&amp;gt; from scapy.all import *
&amp;gt;&amp;gt;&amp;gt; from scapy.layers.ipsec import *
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="build-plaintext-packet"&gt;build plaintext packet&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; p = IP(src=&amp;#39;1.1.1.1&amp;#39;, dst=&amp;#39;2.2.2.2&amp;#39;) / TCP(sport=45012, dport=80) / Raw(&amp;#39;testdata&amp;#39;) 
&amp;gt;&amp;gt;&amp;gt; p = IP(str(p))
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="setup-sa"&gt;setup SA&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; sa = SecurityAssociation(ESP, spi=0xdeadbeef, crypt_algo=&amp;#39;AES-CBC&amp;#39;,crypt_key=&amp;#39;sixteenbytes key&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="encrypt-wo-iv"&gt;Encrypt w/o IV&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; e = sa.encrypt(p, 5)
&amp;gt;&amp;gt;&amp;gt; e
&amp;lt;IP version=4L ihl=5L tos=0x0 len=76 id=1 flags= frag=0L ttl=64 proto=esp chksum=0x747a src=1.1.1.1 dst=2.2.2.2 |&amp;lt;ESP spi=0xdeadbeef seq=5 data=&amp;#39;uD\x7fdj19\xe7\xc4\xff8\x10\xcdQ\xf0\xa6\x1e!\x84\xc3&amp;gt;!\x18\xa6\xf6\xb8\x93\xc6it\x9a\xfc\x1c\xee\xe5C\xcd\xf0\x7fD\xca\x8d\xadKh\xa8\xe5x&amp;#39; |&amp;gt;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; e.show()
###[ IP ]###
 version = 4L
 ihl = 5L
 tos = 0x0
 len = 76
 id = 1
 flags = 
 frag = 0L
 ttl = 64
 proto = esp
 chksum = 0x747a
 src = 1.1.1.1
 dst = 2.2.2.2
 \options \
###[ ESP ]###
 spi = 0xdeadbeef
 seq = 5
 data = &amp;#39;uD\x7fdj19\xe7\xc4\xff8\x10\xcdQ\xf0\xa6\x1e!\x84\xc3&amp;gt;!\x18\xa6\xf6\xb8\x93\xc6it\x9a\xfc\x1c\xee\xe5C\xcd\xf0\x7fD\xca\x8d\xadKh\xa8\xe5x&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="encrypt-w-iv"&gt;Encrypt w/ IV&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; e = sa.encrypt(p, 5, &amp;#34;1234567890123456&amp;#34;)
&amp;gt;&amp;gt;&amp;gt; e
&amp;lt;IP version=4L ihl=5L tos=0x0 len=76 id=1 flags= frag=0L ttl=64 proto=esp chksum=0x747a src=1.1.1.1 dst=2.2.2.2 |&amp;lt;ESP spi=0xdeadbeef seq=5 data=&amp;#39;1234567890123456\xa4\x0b\xebZ\xa7\xc8\xb6\x95\xfb\x13\x07\xc5TD\xa2\xe7DP\xfcP\xa5y\xc4\x06W\xe8\xf5\xf0\x86\xe1\x0c\xfd&amp;#39; |&amp;gt;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; e.show()
###[ IP ]###
 version = 4L
 ihl = 5L
 tos = 0x0
 len = 76
 id = 1
 flags = 
 frag = 0L
 ttl = 64
 proto = esp
 chksum = 0x747a
 src = 1.1.1.1
 dst = 2.2.2.2
 \options \
###[ ESP ]###
 spi = 0xdeadbeef
 seq = 5
 data = &amp;#39;1234567890123456\xa4\x0b\xebZ\xa7\xc8\xb6\x95\xfb\x13\x07\xc5TD\xa2\xe7DP\xfcP\xa5y\xc4\x06W\xe8\xf5\xf0\x86\xe1\x0c\xfd&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;data 의 시작 부분에 IV값 &amp;lsquo;1234567890123456&amp;rsquo;이 있음을 알 수 있다.
ESP는 SPI(4B), SEQ(4B), IV(16B) , Encrypted Data 형태로 구성된다.&lt;/p&gt;</description></item><item><title>Cisco Cloud Services Router 1000V</title><link>https://cychong47.github.io/post/2015/cisco-cloud-services-router-1000v/</link><pubDate>Mon, 23 Nov 2015 14:50:31 +0900</pubDate><guid>https://cychong47.github.io/post/2015/cisco-cloud-services-router-1000v/</guid><description>&lt;p&gt;&lt;a href="http://www.cisco.com/c/en/us/products/collateral/routers/cloud-services-router-1000v-series/datasheet-c78-733443.html"&gt;http://www.cisco.com/c/en/us/products/collateral/routers/cloud-services-router-1000v-series/datasheet-c78-733443.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;How many vCPUs are required for processing.&lt;/p&gt;</description></item></channel></rss>