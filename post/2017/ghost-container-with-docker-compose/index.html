<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ghost container with docker-compose | Keep calm and Write something</title><meta name=title content="ghost container with docker-compose"><meta name=description content="얼마전에 구성한 ghost container는 ghost가 1.x로 업데이트가 되면서 설정 정보의 위치가 변경되었는데 그걸 미처 몰라 블로그 주소가 기본값인 localhost로 설정되는 문제가 있었다.
기존 ghost container에 접근해서 확인해 보니 `/var/lib/ghost/config.production.json&rsquo; 파일에 주소가 설정되어 있는 걸 보고 이 파일도 따로 지정해 주도록 변경했다.
그러면서 docker-compose를 한번 써 보기로
일단 기존 ghost를 정리하고
cychong:~ cychong$ docker stop ghost
ghost
cychong:~ cychong$ docker rm ghost
ghost
cychong:~ cychong$ docker rmi ghost
Untagged: ghost:latest
Untagged: ghost@sha256:a1f70641d35755395eb16827de4e67861e01bffe18bac8e54ab5c68cd170a2ea
Deleted: sha256:e6ba3dd3c2491c6086d570fa9769a9f60d7c004129ff9ae7ff9fa0bad16a993b
Deleted: sha256:c1ee9d43624bb4a1922c15d7a9175a80d1952cb71464d6d9d900fe21948227af
Deleted: sha256:f8f95cdbafce4ecd226cdd690e6f909203a0f83d3507c53a71d4e59826ea881b
Deleted: sha256:935d8847555992b702173b83b0d210f2728a24b5287467396dc8d5c68907691f
Deleted: sha256:f4766b72a49d4cd2e897da0efcec94c33a0d24a95cb8426a790e1c45e6e39fae
Deleted: sha256:0c0dbaebe17c6f585eb596e705ed5acba668097698a7780844c12597bb99b34a
Deleted: sha256:c807796bea7a34c0b73eae853b728f2bbcd7a4fecc19d049455b322120f95ce7
Deleted: sha256:15f9f4e44e22d3287b6caf9555110383d3ff2e88ee9cc03823b1ba5a01b75eac
Deleted: sha256:77809f11069f2abfb571cba07ee3d696ec32823df0f5d0587042ffdb27a80add
Deleted: sha256:5d6bba18f7b25c9b93d3cc0d93a4cff54eb88b0ba22ed867633a21fc3ded5f57
하는 김에 최신 버전의 ghost받아오고"><meta name=keywords content="docker,ghost,container,docker-compose,"><meta property="og:url" content="https://cychong47.github.io/post/2017/ghost-container-with-docker-compose/"><meta property="og:site_name" content="Keep calm and Write something"><meta property="og:title" content="ghost container with docker-compose"><meta property="og:description" content="얼마전에 구성한 ghost container는 ghost가 1.x로 업데이트가 되면서 설정 정보의 위치가 변경되었는데 그걸 미처 몰라 블로그 주소가 기본값인 localhost로 설정되는 문제가 있었다. 기존 ghost container에 접근해서 확인해 보니 `/var/lib/ghost/config.production.json’ 파일에 주소가 설정되어 있는 걸 보고 이 파일도 따로 지정해 주도록 변경했다. 그러면서 docker-compose를 한번 써 보기로
일단 기존 ghost를 정리하고
cychong:~ cychong$ docker stop ghost ghost cychong:~ cychong$ docker rm ghost ghost cychong:~ cychong$ docker rmi ghost Untagged: ghost:latest Untagged: ghost@sha256:a1f70641d35755395eb16827de4e67861e01bffe18bac8e54ab5c68cd170a2ea Deleted: sha256:e6ba3dd3c2491c6086d570fa9769a9f60d7c004129ff9ae7ff9fa0bad16a993b Deleted: sha256:c1ee9d43624bb4a1922c15d7a9175a80d1952cb71464d6d9d900fe21948227af Deleted: sha256:f8f95cdbafce4ecd226cdd690e6f909203a0f83d3507c53a71d4e59826ea881b Deleted: sha256:935d8847555992b702173b83b0d210f2728a24b5287467396dc8d5c68907691f Deleted: sha256:f4766b72a49d4cd2e897da0efcec94c33a0d24a95cb8426a790e1c45e6e39fae Deleted: sha256:0c0dbaebe17c6f585eb596e705ed5acba668097698a7780844c12597bb99b34a Deleted: sha256:c807796bea7a34c0b73eae853b728f2bbcd7a4fecc19d049455b322120f95ce7 Deleted: sha256:15f9f4e44e22d3287b6caf9555110383d3ff2e88ee9cc03823b1ba5a01b75eac Deleted: sha256:77809f11069f2abfb571cba07ee3d696ec32823df0f5d0587042ffdb27a80add Deleted: sha256:5d6bba18f7b25c9b93d3cc0d93a4cff54eb88b0ba22ed867633a21fc3ded5f57 하는 김에 최신 버전의 ghost받아오고"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-09-03T01:26:28+09:00"><meta property="article:modified_time" content="2018-04-01T02:38:51+00:00"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Ghost"><meta property="article:tag" content="Container"><meta property="article:tag" content="Docker-Compose"><meta name=twitter:card content="summary"><meta name=twitter:title content="ghost container with docker-compose"><meta name=twitter:description content="얼마전에 구성한 ghost container는 ghost가 1.x로 업데이트가 되면서 설정 정보의 위치가 변경되었는데 그걸 미처 몰라 블로그 주소가 기본값인 localhost로 설정되는 문제가 있었다. 기존 ghost container에 접근해서 확인해 보니 `/var/lib/ghost/config.production.json’ 파일에 주소가 설정되어 있는 걸 보고 이 파일도 따로 지정해 주도록 변경했다. 그러면서 docker-compose를 한번 써 보기로
일단 기존 ghost를 정리하고
cychong:~ cychong$ docker stop ghost ghost cychong:~ cychong$ docker rm ghost ghost cychong:~ cychong$ docker rmi ghost Untagged: ghost:latest Untagged: ghost@sha256:a1f70641d35755395eb16827de4e67861e01bffe18bac8e54ab5c68cd170a2ea Deleted: sha256:e6ba3dd3c2491c6086d570fa9769a9f60d7c004129ff9ae7ff9fa0bad16a993b Deleted: sha256:c1ee9d43624bb4a1922c15d7a9175a80d1952cb71464d6d9d900fe21948227af Deleted: sha256:f8f95cdbafce4ecd226cdd690e6f909203a0f83d3507c53a71d4e59826ea881b Deleted: sha256:935d8847555992b702173b83b0d210f2728a24b5287467396dc8d5c68907691f Deleted: sha256:f4766b72a49d4cd2e897da0efcec94c33a0d24a95cb8426a790e1c45e6e39fae Deleted: sha256:0c0dbaebe17c6f585eb596e705ed5acba668097698a7780844c12597bb99b34a Deleted: sha256:c807796bea7a34c0b73eae853b728f2bbcd7a4fecc19d049455b322120f95ce7 Deleted: sha256:15f9f4e44e22d3287b6caf9555110383d3ff2e88ee9cc03823b1ba5a01b75eac Deleted: sha256:77809f11069f2abfb571cba07ee3d696ec32823df0f5d0587042ffdb27a80add Deleted: sha256:5d6bba18f7b25c9b93d3cc0d93a4cff54eb88b0ba22ed867633a21fc3ded5f57 하는 김에 최신 버전의 ghost받아오고"><meta itemprop=name content="ghost container with docker-compose"><meta itemprop=description content="얼마전에 구성한 ghost container는 ghost가 1.x로 업데이트가 되면서 설정 정보의 위치가 변경되었는데 그걸 미처 몰라 블로그 주소가 기본값인 localhost로 설정되는 문제가 있었다. 기존 ghost container에 접근해서 확인해 보니 `/var/lib/ghost/config.production.json’ 파일에 주소가 설정되어 있는 걸 보고 이 파일도 따로 지정해 주도록 변경했다. 그러면서 docker-compose를 한번 써 보기로
일단 기존 ghost를 정리하고
cychong:~ cychong$ docker stop ghost ghost cychong:~ cychong$ docker rm ghost ghost cychong:~ cychong$ docker rmi ghost Untagged: ghost:latest Untagged: ghost@sha256:a1f70641d35755395eb16827de4e67861e01bffe18bac8e54ab5c68cd170a2ea Deleted: sha256:e6ba3dd3c2491c6086d570fa9769a9f60d7c004129ff9ae7ff9fa0bad16a993b Deleted: sha256:c1ee9d43624bb4a1922c15d7a9175a80d1952cb71464d6d9d900fe21948227af Deleted: sha256:f8f95cdbafce4ecd226cdd690e6f909203a0f83d3507c53a71d4e59826ea881b Deleted: sha256:935d8847555992b702173b83b0d210f2728a24b5287467396dc8d5c68907691f Deleted: sha256:f4766b72a49d4cd2e897da0efcec94c33a0d24a95cb8426a790e1c45e6e39fae Deleted: sha256:0c0dbaebe17c6f585eb596e705ed5acba668097698a7780844c12597bb99b34a Deleted: sha256:c807796bea7a34c0b73eae853b728f2bbcd7a4fecc19d049455b322120f95ce7 Deleted: sha256:15f9f4e44e22d3287b6caf9555110383d3ff2e88ee9cc03823b1ba5a01b75eac Deleted: sha256:77809f11069f2abfb571cba07ee3d696ec32823df0f5d0587042ffdb27a80add Deleted: sha256:5d6bba18f7b25c9b93d3cc0d93a4cff54eb88b0ba22ed867633a21fc3ded5f57 하는 김에 최신 버전의 ghost받아오고"><meta itemprop=datePublished content="2017-09-03T01:26:28+09:00"><meta itemprop=dateModified content="2018-04-01T02:38:51+00:00"><meta itemprop=wordCount content="575"><meta itemprop=keywords content="Docker,Ghost,Container,Docker-Compose"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style></head><body><header><a href=/ class=title><h2>Keep calm and Write something</h2></a><nav><a href=/post/>Post</a>
<a href=/page/>Page</a>
<a href=/series/>Series</a>
<a href=/tags/>Tag</a>
<a href=/archive/>Archive</a>
<a href=/search/>Search</a></nav></header><main><content><p>얼마전에 구성한 ghost container는 ghost가 1.x로 업데이트가 되면서 설정 정보의 위치가 변경되었는데 그걸 미처 몰라 블로그 주소가 기본값인 localhost로 설정되는 문제가 있었다.
기존 ghost container에 접근해서 확인해 보니 `/var/lib/ghost/config.production.json&rsquo; 파일에 주소가 설정되어 있는 걸 보고 이 파일도 따로 지정해 주도록 변경했다.
그러면서 docker-compose를 한번 써 보기로</p><p>일단 기존 ghost를 정리하고</p><pre tabindex=0><code>cychong:~ cychong$ docker stop ghost
ghost
cychong:~ cychong$ docker rm ghost
ghost
cychong:~ cychong$ docker rmi ghost
Untagged: ghost:latest
Untagged: ghost@sha256:a1f70641d35755395eb16827de4e67861e01bffe18bac8e54ab5c68cd170a2ea
Deleted: sha256:e6ba3dd3c2491c6086d570fa9769a9f60d7c004129ff9ae7ff9fa0bad16a993b
Deleted: sha256:c1ee9d43624bb4a1922c15d7a9175a80d1952cb71464d6d9d900fe21948227af
Deleted: sha256:f8f95cdbafce4ecd226cdd690e6f909203a0f83d3507c53a71d4e59826ea881b
Deleted: sha256:935d8847555992b702173b83b0d210f2728a24b5287467396dc8d5c68907691f
Deleted: sha256:f4766b72a49d4cd2e897da0efcec94c33a0d24a95cb8426a790e1c45e6e39fae
Deleted: sha256:0c0dbaebe17c6f585eb596e705ed5acba668097698a7780844c12597bb99b34a
Deleted: sha256:c807796bea7a34c0b73eae853b728f2bbcd7a4fecc19d049455b322120f95ce7
Deleted: sha256:15f9f4e44e22d3287b6caf9555110383d3ff2e88ee9cc03823b1ba5a01b75eac
Deleted: sha256:77809f11069f2abfb571cba07ee3d696ec32823df0f5d0587042ffdb27a80add
Deleted: sha256:5d6bba18f7b25c9b93d3cc0d93a4cff54eb88b0ba22ed867633a21fc3ded5f57
</code></pre><p>하는 김에 최신 버전의 ghost받아오고</p><pre tabindex=0><code>cychong:~ cychong$ docker pull ghost
Using default tag: latest
latest: Pulling from library/ghost
ad74af05f5a2: Already exists 
2b032b8bbe8b: Pull complete 
ad85906adb69: Pull complete 
3caae50f774b: Pull complete 
ef87a0ce8025: Pull complete 
fc62209fe861: Pull complete 
8610d8088e2a: Pull complete 
c360787a43d4: Pull complete 
5d4f585a7cb1: Pull complete 
e204e870e4fc: Pull complete 
Digest: sha256:6c1adf02635cf2a31479a436192068f60c3cc86242d21093f55783ab1d1dd107
Status: Downloaded newer image for ghost:latest
</code></pre><p><code>docker history</code> 명령을 보니 ghost 버전이 1.8.1로 바뀐 걸 알 수 있네.(좀 쉽게 알 수는 없을까?)</p><pre tabindex=0><code>cychong:~ cychong$ docker history ghost
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
2d71383c27b9        2 days ago          /bin/sh -c #(nop)  CMD [&#34;node&#34; &#34;current/in...   0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  EXPOSE 2368/tcp              0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  ENTRYPOINT [&#34;docker-ent...   0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop) COPY file:ef6da72f41bc8f...   646B                
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  VOLUME [/var/lib/ghost/...   0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop) WORKDIR /var/lib/ghost        0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c set -ex;  mkdir -p &#34;$GHOST_INST...   289MB               
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  ENV GHOST_CONTENT=/var/...   0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  ENV GHOST_INSTALL=/var/...   0B                  
&lt;missing&gt;           2 days ago          /bin/sh -c npm install -g &#34;ghost-cli@$GHOS...   143MB               
&lt;missing&gt;           2 days ago          /bin/sh -c #(nop)  ENV GHOST_VERSION=1.8.1      0B                  
&lt;missing&gt;           8 days ago          /bin/sh -c #(nop)  ENV GHOST_CLI_VERSION=1...   0B                  
&lt;missing&gt;           8 days ago          /bin/sh -c #(nop)  ENV NODE_ENV=production      0B                  
&lt;missing&gt;           8 days ago          /bin/sh -c #(nop)  ENV NPM_CONFIG_LOGLEVEL...   0B                  
&lt;missing&gt;           8 days ago          /bin/sh -c set -x  &amp;&amp; wget -O /usr/local/b...   1.29MB              
&lt;missing&gt;           8 days ago          /bin/sh -c #(nop)  ENV GOSU_VERSION=1.10        0B                  
&lt;missing&gt;           2 weeks ago         /bin/sh -c #(nop)  CMD [&#34;node&#34;]                 0B                  
&lt;missing&gt;           2 weeks ago         /bin/sh -c set -ex   &amp;&amp; for key in     6A0...   3.89MB              
&lt;missing&gt;           2 weeks ago         /bin/sh -c #(nop)  ENV YARN_VERSION=0.27.5      0B                  
&lt;missing&gt;           2 weeks ago         /bin/sh -c buildDeps=&#39;xz-utils&#39;     &amp;&amp; ARC...   42.5MB              
&lt;missing&gt;           4 weeks ago         /bin/sh -c #(nop)  ENV NODE_VERSION=6.11.2      0B                  
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop)  ENV NPM_CONFIG_LOGLEVEL...   0B                  
&lt;missing&gt;           5 weeks ago         /bin/sh -c set -ex   &amp;&amp; for key in     955...   131kB               
&lt;missing&gt;           5 weeks ago         /bin/sh -c groupadd --gid 1000 node   &amp;&amp; u...   335kB               
&lt;missing&gt;           5 weeks ago         /bin/sh -c set -ex;  if ! command -v gpg &gt;...   0B                  
&lt;missing&gt;           5 weeks ago         /bin/sh -c apt-get update &amp;&amp; apt-get insta...   44.6MB              
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop)  CMD [&#34;bash&#34;]                 0B                  
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop) ADD file:a023a99f7d01868...   123MB   
</code></pre><p>my-ghost/docker-compose.yaml</p><pre tabindex=0><code>version: &#39;3&#39;

services:
   ghost:
     container_name: ghost
     image: ghost:latest
     volumes:
       - /Users/cychong/Dropbox/Apps/ghost/content/:/var/lib/ghost/content   
       - /Users/cychong/Dropbox/Apps/ghost/config.production.json:/var/lib/ghost/config.production.json
     ports:
       - &#34;2368:2368&#34;
     restart: always
     environment:
       - NODE_ENV=production
volumes:
    db_data:
</code></pre><p>go!</p><pre tabindex=0><code>cychong:~/work/my_ghost cychong$ docker-compose up -d
Creating network &#34;myghost_default&#34; with the default driver
Creating volume &#34;myghost_db_data&#34; with default driver
Creating ghost ... 
Creating ghost ... done
</code></pre><p>어디 볼까?</p><pre tabindex=0><code>cychong:~/work/my_ghost cychong$ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
dea965b550e6        ghost:latest        &#34;docker-entrypoint...&#34;   17 seconds ago      Up 16 seconds       0.0.0.0:2368-&gt;2368/tcp   ghost
</code></pre><p>잠시 후 웹브라우저로 확인해 보면 제대로 접속은 되는데 의도한 대로 주소가 localhost가 아니라 sosa0sa.com으로 되었는지는 이 글을 publish하면 알 수 있겠지.</p></content><p><a href=https://cychong47.github.io/tags/docker/>#Docker</a>
<a href=https://cychong47.github.io/tags/ghost/>#Ghost</a>
<a href=https://cychong47.github.io/tags/container/>#Container</a>
<a href=https://cychong47.github.io/tags/docker-compose/>#Docker-Compose</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>