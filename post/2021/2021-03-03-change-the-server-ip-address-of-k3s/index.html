<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Change the server IP address of k3s | Keep calm and Write something</title><meta name=title content="Change the server IP address of k3s"><meta name=description content="How to change IP address of k3s
By default, as k3s operates in the local host, it is not possible to connect from other host.
To get the server Ip address,
$ kubectl config view --raw |grep server
    server: https://127.0.0.1:6443
The listening server IP address can be specified by giving parameter in running the k3s binary.
K3s configuration is on /etc/systemd/system/k3s.service
$ cat /etc/systemd/system/k3s.service
[Unit]
Description=Lightweight Kubernetes
Documentation=https://k3s.io
Wants=network-online.target
After=network-online.target

[Install]
WantedBy=multi-user.target

[Service]
Type=notify
EnvironmentFile=/etc/systemd/system/k3s.service.env
KillMode=process
Delegate=yes
# Having non-zero Limit*s causes performance problems due to accounting overhead
# in the kernel. We recommend using cgroups to do container-local accounting.
LimitNOFILE=1048576
LimitNPROC=infinity
LimitCORE=infinity
TasksMax=infinity
TimeoutStartSec=0
Restart=always
RestartSec=5s
ExecStartPre=-/sbin/modprobe br_netfilter
ExecStartPre=-/sbin/modprobe overlay
ExecStart=/usr/local/bin/k3s \
    server \
	'--write-kubeconfig-mode' \
	'644' \
Append server IP address of ExecStart option"><meta name=keywords content="k3s,kubernetes,"><meta property="og:url" content="https://cychong47.github.io/post/2021/2021-03-03-change-the-server-ip-address-of-k3s/"><meta property="og:site_name" content="Keep calm and Write something"><meta property="og:title" content="Change the server IP address of k3s"><meta property="og:description" content="How to change IP address of k3s By default, as k3s operates in the local host, it is not possible to connect from other host.
To get the server Ip address,
$ kubectl config view --raw |grep server server: https://127.0.0.1:6443 The listening server IP address can be specified by giving parameter in running the k3s binary.
K3s configuration is on /etc/systemd/system/k3s.service
$ cat /etc/systemd/system/k3s.service [Unit] Description=Lightweight Kubernetes Documentation=https://k3s.io Wants=network-online.target After=network-online.target [Install] WantedBy=multi-user.target [Service] Type=notify EnvironmentFile=/etc/systemd/system/k3s.service.env KillMode=process Delegate=yes # Having non-zero Limit*s causes performance problems due to accounting overhead # in the kernel. We recommend using cgroups to do container-local accounting. LimitNOFILE=1048576 LimitNPROC=infinity LimitCORE=infinity TasksMax=infinity TimeoutStartSec=0 Restart=always RestartSec=5s ExecStartPre=-/sbin/modprobe br_netfilter ExecStartPre=-/sbin/modprobe overlay ExecStart=/usr/local/bin/k3s \ server \ '--write-kubeconfig-mode' \ '644' \ Append server IP address of ExecStart option"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-03T13:17:28+09:00"><meta property="article:modified_time" content="2021-03-03T13:17:28+09:00"><meta property="article:tag" content="K3s"><meta property="article:tag" content="Kubernetes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Change the server IP address of k3s"><meta name=twitter:description content="How to change IP address of k3s By default, as k3s operates in the local host, it is not possible to connect from other host.
To get the server Ip address,
$ kubectl config view --raw |grep server server: https://127.0.0.1:6443 The listening server IP address can be specified by giving parameter in running the k3s binary.
K3s configuration is on /etc/systemd/system/k3s.service
$ cat /etc/systemd/system/k3s.service [Unit] Description=Lightweight Kubernetes Documentation=https://k3s.io Wants=network-online.target After=network-online.target [Install] WantedBy=multi-user.target [Service] Type=notify EnvironmentFile=/etc/systemd/system/k3s.service.env KillMode=process Delegate=yes # Having non-zero Limit*s causes performance problems due to accounting overhead # in the kernel. We recommend using cgroups to do container-local accounting. LimitNOFILE=1048576 LimitNPROC=infinity LimitCORE=infinity TasksMax=infinity TimeoutStartSec=0 Restart=always RestartSec=5s ExecStartPre=-/sbin/modprobe br_netfilter ExecStartPre=-/sbin/modprobe overlay ExecStart=/usr/local/bin/k3s \ server \ '--write-kubeconfig-mode' \ '644' \ Append server IP address of ExecStart option"><meta itemprop=name content="Change the server IP address of k3s"><meta itemprop=description content="How to change IP address of k3s By default, as k3s operates in the local host, it is not possible to connect from other host.
To get the server Ip address,
$ kubectl config view --raw |grep server server: https://127.0.0.1:6443 The listening server IP address can be specified by giving parameter in running the k3s binary.
K3s configuration is on /etc/systemd/system/k3s.service
$ cat /etc/systemd/system/k3s.service [Unit] Description=Lightweight Kubernetes Documentation=https://k3s.io Wants=network-online.target After=network-online.target [Install] WantedBy=multi-user.target [Service] Type=notify EnvironmentFile=/etc/systemd/system/k3s.service.env KillMode=process Delegate=yes # Having non-zero Limit*s causes performance problems due to accounting overhead # in the kernel. We recommend using cgroups to do container-local accounting. LimitNOFILE=1048576 LimitNPROC=infinity LimitCORE=infinity TasksMax=infinity TimeoutStartSec=0 Restart=always RestartSec=5s ExecStartPre=-/sbin/modprobe br_netfilter ExecStartPre=-/sbin/modprobe overlay ExecStart=/usr/local/bin/k3s \ server \ '--write-kubeconfig-mode' \ '644' \ Append server IP address of ExecStart option"><meta itemprop=datePublished content="2021-03-03T13:17:28+09:00"><meta itemprop=dateModified content="2021-03-03T13:17:28+09:00"><meta itemprop=wordCount content="200"><meta itemprop=keywords content="K3s,Kubernetes"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style></head><body><header><a href=/ class=title><h2>Keep calm and Write something</h2></a><nav><a href=/post/>Post</a>
<a href=/page/>Page</a>
<a href=/series/>Series</a>
<a href=/tags/>Tag</a>
<a href=/archive/>Archive</a>
<a href=/search/>Search</a></nav></header><main><content><h1 id=how-to-change-ip-address-of-k3s>How to change IP address of k3s</h1><p>By default, as k3s operates in the local host, it is not possible to connect from other host.</p><p>To get the server Ip address,</p><pre tabindex=0><code>$ kubectl config view --raw |grep server
    server: https://127.0.0.1:6443
</code></pre><p>The listening server IP address can be specified by giving parameter in running the k3s binary.</p><p>K3s configuration is on <code>/etc/systemd/system/k3s.service</code></p><pre tabindex=0><code>$ cat /etc/systemd/system/k3s.service
[Unit]
Description=Lightweight Kubernetes
Documentation=https://k3s.io
Wants=network-online.target
After=network-online.target

[Install]
WantedBy=multi-user.target

[Service]
Type=notify
EnvironmentFile=/etc/systemd/system/k3s.service.env
KillMode=process
Delegate=yes
# Having non-zero Limit*s causes performance problems due to accounting overhead
# in the kernel. We recommend using cgroups to do container-local accounting.
LimitNOFILE=1048576
LimitNPROC=infinity
LimitCORE=infinity
TasksMax=infinity
TimeoutStartSec=0
Restart=always
RestartSec=5s
ExecStartPre=-/sbin/modprobe br_netfilter
ExecStartPre=-/sbin/modprobe overlay
ExecStart=/usr/local/bin/k3s \
    server \
	&#39;--write-kubeconfig-mode&#39; \
	&#39;644&#39; \
</code></pre><p>Append server IP address of <code>ExecStart</code> option</p><pre tabindex=0><code>ExecStart=/usr/local/bin/k3s \
    server \
        &#39;--write-kubeconfig-mode&#39; \
        &#39;644&#39; \
        --bind-address 0.0.0.0 \
</code></pre><p>Refer to the additional options
<a href=https://rancher.com/docs/k3s/latest/en/installation/install-options/server-config/>Rancher Docs: K3s Server Configuration Reference</a></p><p>Then restart the k3s service</p><pre tabindex=0><code>$ sudo systemctl restart k3s
$ sudo systemctl daemon-reload
</code></pre><p>Check again</p><pre tabindex=0><code>$ kubectl config view --raw |grep server
    server: https://0.0.0.0:6443
</code></pre><p>To use the kube configuration from other host, change the server IP address of result of <code>kubectl config view —raw</code> to the host IP address of node.</p></content><p><a href=https://cychong47.github.io/tags/k3s/>#K3s</a>
<a href=https://cychong47.github.io/tags/kubernetes/>#Kubernetes</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>