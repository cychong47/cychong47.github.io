<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Hugepage in DPDK - Basics | Keep calm and Write something</title><meta name=title content="Hugepage in DPDK - Basics"><meta name=description content="Basic use of hugepage

DPDK application이 hugepage를 사용할 때 다음과 같은 2가지 디렉토리를 사용한다.

DPDK runtime config files

/var/run/dpdk  로 고정된 경로를 사용요
DPDK 에서 hugepage를 어떻게 사용하는 지에 대한 meta data를 저장


hugepage map

hugepage를 사용하기 위해 hugetlbfs 를 이용할 때 생성하는 hugepage map 파일들이 위치한 곳.
DPDK는 이곳에 hugepage의 단위 크기를 갖는 file을 생성하고, mmap()을 사용하여 hugepage를 접근
만일 시스템에 2개 이상의 hugetlbfs가 마운트된 위치가 있는 경우 DPDK process를 실행할 때 --huge-dir 옵션을 사용하여 특정 위치를 사용하도록 할 수 있다.



Multi-process support
"><meta name=keywords content="kubernetes,DPDK,hugepage,"><meta property="og:url" content="https://cychong47.github.io/post/2022/2022-03-14-hugepage-in-dpdk-basics/"><meta property="og:site_name" content="Keep calm and Write something"><meta property="og:title" content="Hugepage in DPDK - Basics"><meta property="og:description" content="Basic use of hugepage DPDK application이 hugepage를 사용할 때 다음과 같은 2가지 디렉토리를 사용한다.
DPDK runtime config files /var/run/dpdk 로 고정된 경로를 사용요 DPDK 에서 hugepage를 어떻게 사용하는 지에 대한 meta data를 저장 hugepage map hugepage를 사용하기 위해 hugetlbfs 를 이용할 때 생성하는 hugepage map 파일들이 위치한 곳. DPDK는 이곳에 hugepage의 단위 크기를 갖는 file을 생성하고, mmap()을 사용하여 hugepage를 접근 만일 시스템에 2개 이상의 hugetlbfs가 마운트된 위치가 있는 경우 DPDK process를 실행할 때 --huge-dir 옵션을 사용하여 특정 위치를 사용하도록 할 수 있다. Multi-process support"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-14T00:00:00+09:00"><meta property="article:modified_time" content="2022-03-14T00:00:00+09:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="DPDK"><meta property="article:tag" content="Hugepage"><meta property="og:see_also" content="https://cychong47.github.io/post/2022/2022-03-14-one-container-in-each-pod/"><meta property="og:see_also" content="https://cychong47.github.io/post/2022/2022-03-14-two-containers-in-a-pod/"><meta property="og:see_also" content="https://cychong47.github.io/post/2022/2022-03-14-a-single-container-in-a-pod/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hugepage in DPDK - Basics"><meta name=twitter:description content="Basic use of hugepage DPDK application이 hugepage를 사용할 때 다음과 같은 2가지 디렉토리를 사용한다.
DPDK runtime config files /var/run/dpdk 로 고정된 경로를 사용요 DPDK 에서 hugepage를 어떻게 사용하는 지에 대한 meta data를 저장 hugepage map hugepage를 사용하기 위해 hugetlbfs 를 이용할 때 생성하는 hugepage map 파일들이 위치한 곳. DPDK는 이곳에 hugepage의 단위 크기를 갖는 file을 생성하고, mmap()을 사용하여 hugepage를 접근 만일 시스템에 2개 이상의 hugetlbfs가 마운트된 위치가 있는 경우 DPDK process를 실행할 때 --huge-dir 옵션을 사용하여 특정 위치를 사용하도록 할 수 있다. Multi-process support"><meta itemprop=name content="Hugepage in DPDK - Basics"><meta itemprop=description content="Basic use of hugepage DPDK application이 hugepage를 사용할 때 다음과 같은 2가지 디렉토리를 사용한다.
DPDK runtime config files /var/run/dpdk 로 고정된 경로를 사용요 DPDK 에서 hugepage를 어떻게 사용하는 지에 대한 meta data를 저장 hugepage map hugepage를 사용하기 위해 hugetlbfs 를 이용할 때 생성하는 hugepage map 파일들이 위치한 곳. DPDK는 이곳에 hugepage의 단위 크기를 갖는 file을 생성하고, mmap()을 사용하여 hugepage를 접근 만일 시스템에 2개 이상의 hugetlbfs가 마운트된 위치가 있는 경우 DPDK process를 실행할 때 --huge-dir 옵션을 사용하여 특정 위치를 사용하도록 할 수 있다. Multi-process support"><meta itemprop=datePublished content="2022-03-14T00:00:00+09:00"><meta itemprop=dateModified content="2022-03-14T00:00:00+09:00"><meta itemprop=wordCount content="163"><meta itemprop=keywords content="Kubernetes,DPDK,Hugepage"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style></head><body><header><a href=/ class=title><h2>Keep calm and Write something</h2></a><nav><a href=/post/>Post</a>
<a href=/page/>Page</a>
<a href=/series/>Series</a>
<a href=/tags/>Tag</a>
<a href=/archive/>Archive</a>
<a href=/search/>Search</a></nav></header><main><content><h2 id=basic-use-of-hugepage>Basic use of hugepage</h2><p><img src=/images/2022/03/2022-03-14-dpdk-hugepage-1.png alt=2022-03-14-dpdk-hugepage-1.png></p><p>DPDK application이 hugepage를 사용할 때 다음과 같은 2가지 디렉토리를 사용한다.</p><ul><li>DPDK runtime config files<ul><li><code>/var/run/dpdk</code> 로 고정된 경로를 사용요</li><li>DPDK 에서 hugepage를 어떻게 사용하는 지에 대한 meta data를 저장</li></ul></li><li>hugepage map<ul><li>hugepage를 사용하기 위해 <code>hugetlbfs</code> 를 이용할 때 생성하는 hugepage map 파일들이 위치한 곳.</li><li>DPDK는 이곳에 hugepage의 단위 크기를 갖는 file을 생성하고, <code>mmap()</code>을 사용하여 hugepage를 접근</li><li>만일 시스템에 2개 이상의 <code>hugetlbfs</code>가 마운트된 위치가 있는 경우 DPDK process를 실행할 때 <code>--huge-dir</code> 옵션을 사용하여 특정 위치를 사용하도록 할 수 있다.</li></ul></li></ul><h2 id=multi-process-support>Multi-process support</h2><p><img src=/images/2022/03/2022-03-14-dpdk-hugepage-2.png alt=2022-03-14-dpdk-hugepage-2.png></p><p>각자 virtual address space를 갖는 두 개이상의 DPDK process는 위 두 개 디렉토리를 공유하여 hugepage에 구성된 DPDK resource들(memzone 및 memzone위에 구성되는 DPDK ring 등)을 공유할 수 있다.</p><p>참고로, 위와 같이 두 개의 process가 hugepage를 공유할 때 하나의 DPDK process만 hugepage map 파일을 만들어 DPDK memzone을 생성하고, 나머지 DPDK process들은 이미 생성된 memzone을 사용한다. 이때 hugepage map을 만들고 memzone을 생성하는 DPDK process를 통상 primary process라고 부르고, primary process가 생성한 hugepage를 참조하는 DPDK process들을 secondary process라고 부른다.</p><h2 id=simplified-view>Simplified view</h2><p><img src=/images/2022/03/2022-03-14-dpdk-hugepage-3.png alt=2022-03-14-dpdk-hugepage-3.png>
<img src=/images/2022/03/2022-03-14-dpdk-hugepage-4.png alt=2022-03-14-dpdk-hugepage-4.png></p><p>#til #dpdk</p></content><p><a href=https://cychong47.github.io/tags/kubernetes/>#Kubernetes</a>
<a href=https://cychong47.github.io/tags/dpdk/>#DPDK</a>
<a href=https://cychong47.github.io/tags/hugepage/>#Hugepage</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>