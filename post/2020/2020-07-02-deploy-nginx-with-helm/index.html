<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Deploy nginx with helm | Keep calm and Write something</title><meta name=title content="Deploy nginx with helm"><meta name=description content='우선 docker로 실행한 nginx container를 종료시키고
cychong@mini1:~/work/helm-chart-github$ docker ps -a |grep nginx
a66786635c60        nginx                     "/docker-entrypoint.…"   7 minutes ago       Up 7 minutes                                       k8s_nginx_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0
85c85322ea59        k8s.gcr.io/pause:3.1      "/pause"                 7 minutes ago       Up 7 minutes                                       k8s_POD_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0
5be06dc3b184        nginx                     "nginx -g &#39;daemon of…"   2 weeks ago         Up 2 weeks                  0.0.0.0:8099->80/tcp   podcast
2812c510a5b6        nginx                     "nginx -g &#39;daemon of…"   2 weeks ago         Up 2 weeks                  0.0.0.0:80->80/tcp     sosa0sa
cychong@mini1:~/work/helm-chart-github$ docker stop 5be06dc3b184
5be06dc3b184
nginx를 구동시킬 helm chart 준비
cychong@mini1:~/work/helm-chart/nginx$ tree -f
.
├── ./Chart.yaml
├── ./README.md
├── ./charts
├── ./nginx-pv.yaml
├── ./templates
│   ├── ./templates/NOTES.txt
│   ├── ./templates/_helpers.tpl
│   ├── ./templates/deployment.yaml
│   ├── ./templates/ingress.yaml
│   ├── ./templates/pvc.yaml
│   ├── ./templates/service.yaml
│   └── ./templates/tests
│       └── ./templates/tests/test-connection.yaml
└── ./values.yaml
우선 PV(Persistent Volume) 생성.'><meta name=keywords content="kubernetes,helm,"><meta property="og:url" content="https://cychong47.github.io/post/2020/2020-07-02-deploy-nginx-with-helm/"><meta property="og:site_name" content="Keep calm and Write something"><meta property="og:title" content="Deploy nginx with helm"><meta property="og:description" content='우선 docker로 실행한 nginx container를 종료시키고
cychong@mini1:~/work/helm-chart-github$ docker ps -a |grep nginx a66786635c60 nginx "/docker-entrypoint.…" 7 minutes ago Up 7 minutes k8s_nginx_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 85c85322ea59 k8s.gcr.io/pause:3.1 "/pause" 7 minutes ago Up 7 minutes k8s_POD_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 5be06dc3b184 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:8099->80/tcp podcast 2812c510a5b6 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:80->80/tcp sosa0sa cychong@mini1:~/work/helm-chart-github$ docker stop 5be06dc3b184 5be06dc3b184 nginx를 구동시킬 helm chart 준비
cychong@mini1:~/work/helm-chart/nginx$ tree -f . ├── ./Chart.yaml ├── ./README.md ├── ./charts ├── ./nginx-pv.yaml ├── ./templates │ ├── ./templates/NOTES.txt │ ├── ./templates/_helpers.tpl │ ├── ./templates/deployment.yaml │ ├── ./templates/ingress.yaml │ ├── ./templates/pvc.yaml │ ├── ./templates/service.yaml │ └── ./templates/tests │ └── ./templates/tests/test-connection.yaml └── ./values.yaml 우선 PV(Persistent Volume) 생성.'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-07-02T23:58:41+09:00"><meta property="article:modified_time" content="2020-07-02T23:58:41+09:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Helm"><meta property="og:see_also" content="https://cychong47.github.io/post/2023/2023-05-18-add-search-to-hugo/"><meta property="og:see_also" content="https://cychong47.github.io/post/2020/2020-09-12-image-is-not-jpg-but-heic/"><meta property="og:see_also" content="https://cychong47.github.io/post/2020/2020-06-27-how-to-support-video/"><meta property="og:see_also" content="https://cychong47.github.io/post/2020/2020-06-13-add-menu-to-hugo/"><meta property="og:see_also" content="https://cychong47.github.io/post/2020/2020-06-07-migrate-ghost-to-hugo/"><meta property="og:see_also" content="https://cychong47.github.io/post/2020/hugo-seutp-with-git/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy nginx with helm"><meta name=twitter:description content='우선 docker로 실행한 nginx container를 종료시키고
cychong@mini1:~/work/helm-chart-github$ docker ps -a |grep nginx a66786635c60 nginx "/docker-entrypoint.…" 7 minutes ago Up 7 minutes k8s_nginx_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 85c85322ea59 k8s.gcr.io/pause:3.1 "/pause" 7 minutes ago Up 7 minutes k8s_POD_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 5be06dc3b184 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:8099->80/tcp podcast 2812c510a5b6 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:80->80/tcp sosa0sa cychong@mini1:~/work/helm-chart-github$ docker stop 5be06dc3b184 5be06dc3b184 nginx를 구동시킬 helm chart 준비
cychong@mini1:~/work/helm-chart/nginx$ tree -f . ├── ./Chart.yaml ├── ./README.md ├── ./charts ├── ./nginx-pv.yaml ├── ./templates │ ├── ./templates/NOTES.txt │ ├── ./templates/_helpers.tpl │ ├── ./templates/deployment.yaml │ ├── ./templates/ingress.yaml │ ├── ./templates/pvc.yaml │ ├── ./templates/service.yaml │ └── ./templates/tests │ └── ./templates/tests/test-connection.yaml └── ./values.yaml 우선 PV(Persistent Volume) 생성.'><meta itemprop=name content="Deploy nginx with helm"><meta itemprop=description content='우선 docker로 실행한 nginx container를 종료시키고
cychong@mini1:~/work/helm-chart-github$ docker ps -a |grep nginx a66786635c60 nginx "/docker-entrypoint.…" 7 minutes ago Up 7 minutes k8s_nginx_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 85c85322ea59 k8s.gcr.io/pause:3.1 "/pause" 7 minutes ago Up 7 minutes k8s_POD_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0 5be06dc3b184 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:8099->80/tcp podcast 2812c510a5b6 nginx "nginx -g &#39;daemon of…" 2 weeks ago Up 2 weeks 0.0.0.0:80->80/tcp sosa0sa cychong@mini1:~/work/helm-chart-github$ docker stop 5be06dc3b184 5be06dc3b184 nginx를 구동시킬 helm chart 준비
cychong@mini1:~/work/helm-chart/nginx$ tree -f . ├── ./Chart.yaml ├── ./README.md ├── ./charts ├── ./nginx-pv.yaml ├── ./templates │ ├── ./templates/NOTES.txt │ ├── ./templates/_helpers.tpl │ ├── ./templates/deployment.yaml │ ├── ./templates/ingress.yaml │ ├── ./templates/pvc.yaml │ ├── ./templates/service.yaml │ └── ./templates/tests │ └── ./templates/tests/test-connection.yaml └── ./values.yaml 우선 PV(Persistent Volume) 생성.'><meta itemprop=datePublished content="2020-07-02T23:58:41+09:00"><meta itemprop=dateModified content="2020-07-02T23:58:41+09:00"><meta itemprop=wordCount content="231"><meta itemprop=keywords content="Kubernetes,Helm"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#fafafa;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style></head><body><header><a href=/ class=title><h2>Keep calm and Write something</h2></a><nav><a href=/post/>Post</a>
<a href=/page/>Page</a>
<a href=/series/>Series</a>
<a href=/tags/>Tag</a>
<a href=/archive/>Archive</a>
<a href=/search/>Search</a></nav></header><main><content><p>우선 <code>docker</code>로 실행한 nginx container를 종료시키고</p><pre tabindex=0><code>cychong@mini1:~/work/helm-chart-github$ docker ps -a |grep nginx
a66786635c60        nginx                     &#34;/docker-entrypoint.…&#34;   7 minutes ago       Up 7 minutes                                       k8s_nginx_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0
85c85322ea59        k8s.gcr.io/pause:3.1      &#34;/pause&#34;                 7 minutes ago       Up 7 minutes                                       k8s_POD_my-nginx-77596b9fc6-7txns_default_44840d63-b496-4a58-9e18-83e503c6d2cf_0
5be06dc3b184        nginx                     &#34;nginx -g &#39;daemon of…&#34;   2 weeks ago         Up 2 weeks                  0.0.0.0:8099-&gt;80/tcp   podcast
2812c510a5b6        nginx                     &#34;nginx -g &#39;daemon of…&#34;   2 weeks ago         Up 2 weeks                  0.0.0.0:80-&gt;80/tcp     sosa0sa
cychong@mini1:~/work/helm-chart-github$ docker stop 5be06dc3b184
5be06dc3b184
</code></pre><p>nginx를 구동시킬 helm chart 준비</p><pre tabindex=0><code>cychong@mini1:~/work/helm-chart/nginx$ tree -f
.
├── ./Chart.yaml
├── ./README.md
├── ./charts
├── ./nginx-pv.yaml
├── ./templates
│   ├── ./templates/NOTES.txt
│   ├── ./templates/_helpers.tpl
│   ├── ./templates/deployment.yaml
│   ├── ./templates/ingress.yaml
│   ├── ./templates/pvc.yaml
│   ├── ./templates/service.yaml
│   └── ./templates/tests
│       └── ./templates/tests/test-connection.yaml
└── ./values.yaml
</code></pre><p>우선 PV(<code>Persistent Volume</code>) 생성.</p><pre tabindex=0><code>cychong@mini1:~/work/helm-chart$ kubectl delete -f nginx/nginx-pv.yaml
persistentvolume &#34;nginx-pv&#34; deleted
cychong@mini1:~/work/helm-chart$ kubectl create -f nginx/nginx-pv.yaml
persistentvolume/nginx-pv created
cychong@mini1:~/work/helm-chart$ helm install podcast nginx
NAME: podcast
LAST DEPLOYED: Fri Jul  3 00:01:05 2020
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export NODE_PORT=$(kubectl get --namespace default -o jsonpath=&#34;{.spec.ports[0].nodePort}&#34; services podcast-nginx)
  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath=&#34;{.items[0].status.addresses[0].address}&#34;)
  echo http://$NODE_IP:$NODE_PORT
cychong@mini1:~/work/helm-chart$ kubectl get pods
NAME                             READY   STATUS    RESTARTS   AGE
podcast-nginx-8674747f9c-5tdlf   1/1     Running   0          11s
cychong@mini1:~/work/helm-chart$ kubectl get svc
NAME            TYPE        CLUSTER-IP      EXTERNAL-IP     PORT(S)          AGE
kubernetes      ClusterIP   10.96.0.1       &lt;none&gt;          443/TCP          298d
podcast-nginx   NodePort    10.107.86.180   192.168.1.100   8099:30492/TCP   14s
</code></pre><pre tabindex=0><code> 1361  kubectl delete -f nginx/sosa0sa-pv.yaml
 1362  kubectl create -f nginx/sosa0sa-pv.yaml
 1363  helm install -f values-sosa0sa.yaml sosa0sa nginx
</code></pre></content><p><a href=https://cychong47.github.io/tags/kubernetes/>#Kubernetes</a>
<a href=https://cychong47.github.io/tags/helm/>#Helm</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>